# AI 기반 캐릭터 제작 파이프라인

## **AI 원스톱: 컨셉부터 이펙트까지**
---
NVIDIA DGX 128G활용.

## 1. 개입 수준별 3단계 제작 시나리오. (기본 안)

### 0단계: 극단적 자동화 (Agent-Led)

**특징:** AI 에이전트가 컨셉-모델-모션까지 한 번에 수행

**투입:** 사람의 프롬프트 입력 1회

**결과:** 하루 5~10개 시안 도출. NPC나 단순 몬스터, 배경 오브젝트 생성에 적합

**한계:** 관절 꺾임이나 텍스처 뭉개짐 등 '디테일한 결함' 발생 가능

---

### 1단계: 하이브리드 최적화 (Human-Guided)

**특징:** 주요 관문(Gate)에서 전문가가 검수 및 수정

**투입:** 기획자 1명, 아티스트 1명이 모델링 리토폴로지 및 리깅 웨이트 값 수정

**결과:** 2일 소요. 실제 플레이 가능한 수준의 '서브 클래스'나 '고급 몬스터' 제작 가능

**효과:** AI의 생산성과 사람의 미적 감각이 결합되어 퀄리티 급상승

---

### 2단계: 프리미엄 퀄리티 (Human-Centric Refinement)

**특징:** AI는 '기초 공사'만 담당, 장인 정신으로 디테일 업

**투입:** 파트별 전문가들이 5~10일간 텍스처 페인팅, 스킬 이펙트 타이밍, 모션 블렌딩 미세 조정

**결과:** <레전드 오브 이미르>의 메인 클래스(PC) 수준의 압도적 퀄리티

**장점:** 순수 수작업 대비 제작 기간을 50% 이상 단축하면서도 최상의 결과물 보장

---

## 2. 프로세스 세부 내용 및 활용 기술 (R&D 포인트)

### 컨셉 원화

1. **FLUX.1 [pro/dev]** - 컨셉 메인 원화 생성
2. **FLUX.1 [pro/dev] + X-Labs ControlNet** - 원화를 A-Pose로 변환
3. **SAM (Segment Anything Model)** - 부위별(갑옷, 피부, 천 등) 자동 마스킹 및 분리

### 메시 추출

4. **InstantMesh / LGM (Large Gaussian Model)** - (Hi-poly to Low-poly) 지브러시 모델 생성
5. **Auto-Retopology AI** - 지브러시 급 데이터를 인게임용 폴리곤으로 최적화

### 리깅 및 기초 애니메이션

6. **AccuRig API / RigNet** - 관절 포인트 자동 추출 및 본(Bone) 심기
7. **Mixamo / Motion Matching** - 기본 대기/걷기 애니메이션 자동 리타겟팅

### 이펙트

8. **LLM 활용** - Unreal Engine의 나이아가라 모듈 스크립트(HLSL, Python API) 자동 생성

---

## 3. 극단적 활용 기술 (R&D 포인트)

### 비전 피드백 루프 에이전트 (오케스트레이션)

#### ① 로컬 비전 피드백 (Local Visual QA)

외부 API 없이 DGX 내부에서 동작하기 때문에 보안은 물론, **지연 시간(Latency)**이 거의 없습니다.

**작업:** 3D 모델의 렌더링 샷(다각도)을 비전 모델에 입력

**프롬프트 전략:**
> "너는 15년 차 시니어 게임 아티스트야. 이 3D 모델이 원화와 비교했을 때, 특히 북유럽풍 갑옷의 금속 질감과 관절 리깅 깨짐 위주로 피드백을 줘."

#### ② 자동 교정 명령 (Self-Correction Loop)

비전 모델이 낸 피드백은 텍스트에 그치지 않고, 파이프라인의 **변수(Parameter)**로 치환됩니다.

**텍스처 뭉개짐 감지 시:**
- 비전 AI가 "어깨 부위 텍스처 불량" 판정
- → FLUX.1에게 해당 부위만 Inpainting 하도록 프롬프트 재하달

**관절 깨짐 감지 시:**
- "무릎 관절 폴리곤 중첩" 판정
- → Auto-Retopology AI 단계로 돌아가 폴리곤 밀도를 높여 재생성하도록 명령

---

## 4. DGX의 128GB 운용 시나리오

| 모델 구분 | 추천 모델 및 최적화 수준 | 예상 메모리 점유 | 비고 |
|---------|---------------------|---------------|------|
| 비전 에이전트 | Llama 3.2-Vision (90B)<br>(4-bit 양자화) | 약 55 ~ 60 GB | 에이전트의 '눈'과 '뇌' 역할 |
| 이미지 생성 | FLUX.1 [dev]<br>(8-bit fp8) | 약 16 ~ 20 GB | 원화 및 텍스처 생성 |
| 3D/애니메이션 | LGM / InstantMesh / SAM 2 | 약 15 ~ 20 GB | 필요 시 로드/언로드 가능 |
| 기타 시스템 | OS, 파이프라인 컨트롤러,<br>3D 엔진(UE5) | 약 15 ~ 20 GB | 언리얼 엔진 동시 구동 시 |
| **합계** | **파이프라인 통합 가동** | **약 110 ~ 120 GB** | **여유 공간 확보 가능** |

---

## 5. 레전드 오브 이미르 만의 화풍 해법

### FLUX.1 [dev] 모델을 기반으로 한 'Dreambooth LoRA' 학습

### 1. 데이터셋 준비 (Dataset: 퀄리티의 90%)

DGX의 성능을 100% 뽑아내려면 학습 데이터의 질이 가장 중요합니다.

**수량 및 품질:**
- <이미르>의 고퀄리티 원화 및 인게임 렌더링 샷 30~50장
- 1024x1024 이상, 무손실 PNG 권장

**다양성:**
- **질감(Texture):** 금속 갑옷의 부식된 느낌, 가죽의 거친 결, 북유럽풍 털 가죽 등 클로즈업 샷 포함
- **구도:** 캐릭터 전체 샷, 전/측/후면 시트, 특정 갑옷 파츠 디테일

**배경 제거:**
- 캐릭터 학습 효율을 높이기 위해 배경이 없는(Solid color 또는 Transparent) 이미지가 유리
- SAM 2를 활용해 자동 추출 가능

---

### 2. DGX 전용 학습 세팅 (Training Parameters)

DGX Spark 128G는 VRAM 걱정이 없으므로 고해상도 풀 트레이닝이 가능합니다.

**학습 모델:** FLUX.1 [dev] (FP16 또는 BF16 풀 정밀도 활용)

**핵심 파라미터:**
- **LoRA Rank (Dim):** 64 ~ 128 (복잡한 갑옷 문양과 질감을 살리기 위해 일반적인 32보다 높게 설정)
- **Learning Rate:** 1e-4 ~ 4e-4 (안정적인 학습을 위해 낮은 수치에서 시작)
- **Optimizer:** AdamW8bit 또는 Prodigy (DGX 최적화)
- **Batch Size:** 4 ~ 8 (128G VRAM 덕분에 대용량 배치가 가능하여 학습 속도 대폭 향상)
- **Trigger Word:** `YmirArmorStyle`이나 `YmirNordic` 같은 고유 토큰을 지정하여 해당 단어 입력 시 스타일이 즉시 발현되게 합니다

---

### 3. 스타일 고정을 위한 "이미르 가이드라인" 구축

단순히 그림을 그리는 게 아니라, **'이미르다움'**을 유지하는 시스템적 장치입니다.

#### ① 전용 LoRA 레이어 활용

학습된 LoRA를 ComfyUI나 Automatic1111에서 적용할 때, **Strength(가중치)**를 조절하여 기존 FLUX의 창의성과 이미르의 스타일을 섞습니다.

**권장 가중치:** 0.7 ~ 0.9

#### ② 캡셔닝(Captioning) 전략

이미지마다 상세한 설명을 붙여 학습시킵니다.

**예시:**
> A character in YmirArmorStyle, heavy ornate metal plate with nordic runes, worn leather straps, fur cape, cold cinematic lighting.

이렇게 학습하면 나중에 "heavy ornate metal"만 쳐도 <이미르> 특유의 갑옷 질감이 자동으로 튀어나옵니다.

#### ③ ControlNet Union 연동

FLUX용 최신 **ControlNet (Canny 또는 Depth)**을 병행 사용합니다.

기획자가 그린 낙서 수준의 스케치라도, 학습된 LoRA와 ControlNet이 결합되면 <이미르> 스타일의 완성된 원화로 변환됩니다.

---

## 요약

이 AI 기반 캐릭터 제작 파이프라인은 자동화 수준에 따라 3단계로 나뉘며, DGX의 강력한 하드웨어를 활용하여 컨셉부터 이펙트까지 통합 제작이 가능합니다. 특히 레전드 오브 이미르의 고유한 화풍을 LoRA 학습을 통해 재현하고, 비전 피드백 루프를 통한 자동 품질 검증 시스템으로 제작 효율과 퀄리티를 동시에 확보할 수 있습니다.
